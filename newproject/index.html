<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gestión de Ventas</title>

  <!-- Tailwind local -->
  <link rel="stylesheet" href="./assets/css/tailwind.min.css">

  <!-- Manifest local -->
  <link rel="manifest" href="./manifest.json">

  <meta name="theme-color" content="#4F46E5">

  <!-- Iconos Lucide locale (UMD) -->
  <script defer src="./assets/js/lucide.min.js"></script>

  <style>
    body { background-color: #f3f4f6; }
    .container-app { max-width: 100vw; min-height: 100vh; padding-bottom: 72px; }
    #nav-bar { position: fixed; bottom:0; left:0; right:0; z-index:50; background:white; box-shadow:0 -4px 6px rgba(0,0,0,0.1); }
    .nav-item { display:flex; flex-direction:column; align-items:center; padding:8px 4px; cursor:pointer; }
    .nav-item.active { color:#4F46E5; }
    .modal { transition:opacity .3s ease, visibility .3s ease; }
    .modal-content { transform:translateY(20px); transition:transform .3s ease; }
    .modal.open .modal-content { transform:translateY(0); }
    .table-scroll { overflow-x:auto; }
  </style>
</head>

<body class="font-sans">

  <div id="app" class="container-app mx-auto p-4 md:p-6">
    <header class="mb-6">
      <h1 class="text-3xl font-bold text-gray-800 text-center md:text-left">
        Gestión de Ventas Local
      </h1>
      <p class="text-gray-600 text-center md:text-left">
        Seguimiento de Metas y Productividad
      </p>
    </header>

    <!-- CONTENIDO DINÁMICO -->
    <main id="content" class="bg-white p-4 rounded-xl shadow-lg"></main>

    <!-- MODAL -->
    <div id="message-modal" class="modal fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 opacity-0 invisible">
      <div class="modal-content bg-white p-6 rounded-lg shadow-2xl w-full max-w-sm">
        <h3 id="message-title" class="text-xl font-semibold text-gray-800 mb-3"></h3>
        <p id="message-body" class="text-gray-600 mb-6"></p>
        <div class="flex justify-end">
          <button onclick="app.closeModal()" class="px-4 py-2 bg-primary text-white rounded-lg">Aceptar</button>
        </div>
      </div>
    </div>

    <!-- LOADING -->
    <div id="loading-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 opacity-0 invisible">
      <div class="flex flex-col items-center">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
        <p class="mt-4 text-white text-lg">Sincronizando...</p>
      </div>
    </div>

  </div>

  <!-- BARRA DE NAVEGACIÓN -->
  <nav id="nav-bar" class="flex justify-around">
    <div class="nav-item active" data-view="dashboard" onclick="app.renderView('dashboard')">
      <i data-lucide="home" class="w-5 h-5"></i><span class="text-xs">Tablero</span>
    </div>
    <div class="nav-item" data-view="goals" onclick="app.renderView('goals')">
      <i data-lucide="target" class="w-5 h-5"></i><span class="text-xs">Metas</span>
    </div>
    <div class="nav-item" data-view="sales" onclick="app.renderView('sales')">
      <i data-lucide="trending-up" class="w-5 h-5"></i><span class="text-xs">Ventas</span>
    </div>
    <div class="nav-item" data-view="productivity" onclick="app.renderView('productivity')">
      <i data-lucide="users" class="w-5 h-5"></i><span class="text-xs">Productividad</span>
    </div>
    <div class="nav-item" data-view="settings" onclick="app.renderView('settings')">
      <i data-lucide="settings" class="w-5 h-5"></i><span class="text-xs">Config</span>
    </div>
  </nav>

  <!-- APP LOGIC -->
  <script src="./app.js"></script>

  <!-- SW REGISTRO -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js")
      .then(() => console.log("SW registrado"))
      .catch(err => console.log("SW error:", err));
    }
  </script>

</body>
</html>